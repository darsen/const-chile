using System;
using System.Collections.Generic;
using System.Linq;
using System.Linq.Expressions;
using ConstChile.Indicators;
using ConstChile.Sii;
using NUnit.Framework;

namespace ConstChile.Test
{
    public class Given_DolarScraper_For_Year_2013
    {
        private DolarScraper scraper;

        [SetUp]
        public void CreateScraper()
        {
            scraper = new DolarScraper(2013);
        }
        
        [Test]
        public void Extract_returns_248_indicators()
        {
            scraper.Extract();
            Assert.AreEqual(248, scraper.Dolars.Count);
        }

        [Test]
        public void 
            Extract_returns_exact_entries()
        {
            Dolar[] expectedDollars =
                {
                #region Year 2013 indicators 
                       new Dolar() { Date = new DateTime(2013,2,1), Value = 471.44m},new Dolar() { Date = new DateTime(2013,3,1), Value = 472.96m},new Dolar() { Date = new DateTime(2013,4,1), Value = 472.03m},new Dolar() { Date = new DateTime(2013,7,1), Value = 507.16m},new Dolar() { Date = new DateTime(2013,8,1), Value = 515.42m},new Dolar() { Date = new DateTime(2013,10,1), Value = 504.20m},new Dolar() { Date = new DateTime(2013,1,2), Value = 479.96m},new Dolar() { Date = new DateTime(2013,4,2), Value = 472.51m},new Dolar() { Date = new DateTime(2013,5,2), Value = 471.31m},new Dolar() { Date = new DateTime(2013,7,2), Value = 504.99m},new Dolar() { Date = new DateTime(2013,8,2), Value = 514.42m},new Dolar() { Date = new DateTime(2013,9,2), Value = 509.74m},new Dolar() { Date = new DateTime(2013,10,2), Value = 503.90m},new Dolar() { Date = new DateTime(2013,12,2), Value = 529.64m},new Dolar() { Date = new DateTime(2013,1,3), Value = 475.31m},new Dolar() { Date = new DateTime(2013,4,3), Value = 472.55m},new Dolar() { Date = new DateTime(2013,5,3), Value = 472.44m},new Dolar() { Date = new DateTime(2013,6,3), Value = 499.78m},new Dolar() { Date = new DateTime(2013,7,3), Value = 503.42m},new Dolar() { Date = new DateTime(2013,9,3), Value = 509.75m},new Dolar() { Date = new DateTime(2013,10,3), Value = 502.75m},new Dolar() { Date = new DateTime(2013,12,3), Value = 532.21m},new Dolar() { Date = new DateTime(2013,1,4), Value = 473.25m},new Dolar() { Date = new DateTime(2013,2,4), Value = 471.64m},new Dolar() { Date = new DateTime(2013,3,4), Value = 474.31m},new Dolar() { Date = new DateTime(2013,4,4), Value = 472.38m},new Dolar() { Date = new DateTime(2013,6,4), Value = 501.99m},new Dolar() { Date = new DateTime(2013,7,4), Value = 503.21m},new Dolar() { Date = new DateTime(2013,9,4), Value = 510.38m},new Dolar() { Date = new DateTime(2013,10,4), Value = 500.30m},new Dolar() { Date = new DateTime(2013,11,4), Value = 507.64m},new Dolar() { Date = new DateTime(2013,12,4), Value = 532.97m},new Dolar() { Date = new DateTime(2013,2,5), Value = 472.27m},new Dolar() { Date = new DateTime(2013,3,5), Value = 474.82m},new Dolar() { Date = new DateTime(2013,4,5), Value = 470.83m},new Dolar() { Date = new DateTime(2013,6,5), Value = 499.85m},new Dolar() { Date = new DateTime(2013,7,5), Value = 501.44m},new Dolar() { Date = new DateTime(2013,8,5), Value = 513.63m},new Dolar() { Date = new DateTime(2013,9,5), Value = 508.56m},new Dolar() { Date = new DateTime(2013,11,5), Value = 512.53m},new Dolar() { Date = new DateTime(2013,12,5), Value = 533.95m},new Dolar() { Date = new DateTime(2013,2,6), Value = 472.39m},new Dolar() { Date = new DateTime(2013,3,6), Value = 473.01m},new Dolar() { Date = new DateTime(2013,5,6), Value = 469.73m},new Dolar() { Date = new DateTime(2013,6,6), Value = 502.48m},new Dolar() { Date = new DateTime(2013,8,6), Value = 512.33m},new Dolar() { Date = new DateTime(2013,9,6), Value = 509.46m},new Dolar() { Date = new DateTime(2013,11,6), Value = 514.90m},new Dolar() { Date = new DateTime(2013,12,6), Value = 531.15m},new Dolar() { Date = new DateTime(2013,1,7), Value = 473.13m},new Dolar() { Date = new DateTime(2013,2,7), Value = 473.23m},new Dolar() { Date = new DateTime(2013,3,7), Value = 472.70m},new Dolar() { Date = new DateTime(2013,5,7), Value = 469.64m},new Dolar() { Date = new DateTime(2013,6,7), Value = 505.09m},new Dolar() { Date = new DateTime(2013,8,7), Value = 514.04m},new Dolar() { Date = new DateTime(2013,10,7), Value = 498.88m},new Dolar() { Date = new DateTime(2013,11,7), Value = 514.72m},new Dolar() { Date = new DateTime(2013,1,8), Value = 471.47m},new Dolar() { Date = new DateTime(2013,2,8), Value = 472.62m},new Dolar() { Date = new DateTime(2013,3,8), Value = 472.06m},new Dolar() { Date = new DateTime(2013,4,8), Value = 469.28m},new Dolar() { Date = new DateTime(2013,5,8), Value = 470.07m},new Dolar() { Date = new DateTime(2013,7,8), Value = 506.96m},new Dolar() { Date = new DateTime(2013,8,8), Value = 515.84m},new Dolar() { Date = new DateTime(2013,10,8), Value = 499.51m},new Dolar() { Date = new DateTime(2013,11,8), Value = 515.40m},new Dolar() { Date = new DateTime(2013,1,9), Value = 471.36m},new Dolar() { Date = new DateTime(2013,4,9), Value = 467.38m},new Dolar() { Date = new DateTime(2013,5,9), Value = 471.06m},new Dolar() { Date = new DateTime(2013,7,9), Value = 506.61m},new Dolar() { Date = new DateTime(2013,8,9), Value = 510.65m},new Dolar() { Date = new DateTime(2013,9,9), Value = 506.97m},new Dolar() { Date = new DateTime(2013,10,9), Value = 498.95m},new Dolar() { Date = new DateTime(2013,12,9), Value = 528.59m},new Dolar() { Date = new DateTime(2013,1,10), Value = 471.15m},new Dolar() { Date = new DateTime(2013,4,10), Value = 466.50m},new Dolar() { Date = new DateTime(2013,5,10), Value = 472.03m},new Dolar() { Date = new DateTime(2013,6,10), Value = 501.52m},new Dolar() { Date = new DateTime(2013,7,10), Value = 507.65m},new Dolar() { Date = new DateTime(2013,9,10), Value = 507.74m},new Dolar() { Date = new DateTime(2013,10,10), Value = 500.72m},new Dolar() { Date = new DateTime(2013,12,10), Value = 527.08m},new Dolar() { Date = new DateTime(2013,1,11), Value = 470.67m},new Dolar() { Date = new DateTime(2013,2,11), Value = 472.55m},new Dolar() { Date = new DateTime(2013,3,11), Value = 471.90m},new Dolar() { Date = new DateTime(2013,4,11), Value = 468.54m},new Dolar() { Date = new DateTime(2013,6,11), Value = 504.75m},new Dolar() { Date = new DateTime(2013,7,11), Value = 508.29m},new Dolar() { Date = new DateTime(2013,9,11), Value = 506.80m},new Dolar() { Date = new DateTime(2013,10,11), Value = 498.36m},new Dolar() { Date = new DateTime(2013,11,11), Value = 518.05m},new Dolar() { Date = new DateTime(2013,12,11), Value = 530.66m},new Dolar() { Date = new DateTime(2013,2,12), Value = 472.71m},new Dolar() { Date = new DateTime(2013,3,12), Value = 471.69m},new Dolar() { Date = new DateTime(2013,4,12), Value = 468.74m},new Dolar() { Date = new DateTime(2013,6,12), Value = 503.59m},new Dolar() { Date = new DateTime(2013,7,12), Value = 505.73m},new Dolar() { Date = new DateTime(2013,8,12), Value = 507.05m},new Dolar() { Date = new DateTime(2013,9,12), Value = 503.92m},new Dolar() { Date = new DateTime(2013,11,12), Value = 520.00m},new Dolar() { Date = new DateTime(2013,12,12), Value = 532.04m},new Dolar() { Date = new DateTime(2013,2,13), Value = 472.20m},new Dolar() { Date = new DateTime(2013,3,13), Value = 471.16m},new Dolar() { Date = new DateTime(2013,5,13), Value = 474.04m},new Dolar() { Date = new DateTime(2013,6,13), Value = 498.85m},new Dolar() { Date = new DateTime(2013,8,13), Value = 506.78m},new Dolar() { Date = new DateTime(2013,9,13), Value = 501.98m},new Dolar() { Date = new DateTime(2013,11,13), Value = 520.69m},new Dolar() { Date = new DateTime(2013,12,13), Value = 532.80m},new Dolar() { Date = new DateTime(2013,1,14), Value = 471.92m},new Dolar() { Date = new DateTime(2013,2,14), Value = 470.67m},new Dolar() { Date = new DateTime(2013,3,14), Value = 471.28m},new Dolar() { Date = new DateTime(2013,5,14), Value = 475.68m},new Dolar() { Date = new DateTime(2013,6,14), Value = 496.71m},new Dolar() { Date = new DateTime(2013,8,14), Value = 510.53m},new Dolar() { Date = new DateTime(2013,10,14), Value = 497.44m},new Dolar() { Date = new DateTime(2013,11,14), Value = 522.07m},new Dolar() { Date = new DateTime(2013,1,15), Value = 472.62m},new Dolar() { Date = new DateTime(2013,2,15), Value = 470.83m},new Dolar() { Date = new DateTime(2013,3,15), Value = 471.10m},new Dolar() { Date = new DateTime(2013,4,15), Value = 469.24m},new Dolar() { Date = new DateTime(2013,5,15), Value = 477.32m},new Dolar() { Date = new DateTime(2013,7,15), Value = 504.54m},new Dolar() { Date = new DateTime(2013,10,15), Value = 498.77m},new Dolar() { Date = new DateTime(2013,11,15), Value = 520.89m},new Dolar() { Date = new DateTime(2013,1,16), Value = 474.90m},new Dolar() { Date = new DateTime(2013,4,16), Value = 472.12m},new Dolar() { Date = new DateTime(2013,5,16), Value = 478.71m},new Dolar() { Date = new DateTime(2013,8,16), Value = 509.12m},new Dolar() { Date = new DateTime(2013,9,16), Value = 504.14m},new Dolar() { Date = new DateTime(2013,10,16), Value = 498.66m},new Dolar() { Date = new DateTime(2013,12,16), Value = 529.50m},new Dolar() { Date = new DateTime(2013,1,17), Value = 475.47m},new Dolar() { Date = new DateTime(2013,4,17), Value = 472.07m},new Dolar() { Date = new DateTime(2013,5,17), Value = 479.04m},new Dolar() { Date = new DateTime(2013,6,17), Value = 492.59m},new Dolar() { Date = new DateTime(2013,7,17), Value = 501.59m},new Dolar() { Date = new DateTime(2013,9,17), Value = 502.44m},new Dolar() { Date = new DateTime(2013,10,17), Value = 496.89m},new Dolar() { Date = new DateTime(2013,12,17), Value = 528.27m},new Dolar() { Date = new DateTime(2013,1,18), Value = 473.06m},new Dolar() { Date = new DateTime(2013,2,18), Value = 470.87m},new Dolar() { Date = new DateTime(2013,3,18), Value = 471.63m},new Dolar() { Date = new DateTime(2013,4,18), Value = 473.80m},new Dolar() { Date = new DateTime(2013,6,18), Value = 492.90m},new Dolar() { Date = new DateTime(2013,7,18), Value = 497.79m},new Dolar() { Date = new DateTime(2013,10,18), Value = 493.36m},new Dolar() { Date = new DateTime(2013,11,18), Value = 520.73m},new Dolar() { Date = new DateTime(2013,12,18), Value = 526.38m},new Dolar() { Date = new DateTime(2013,2,19), Value = 471.89m},new Dolar() { Date = new DateTime(2013,3,19), Value = 472.38m},new Dolar() { Date = new DateTime(2013,4,19), Value = 475.93m},new Dolar() { Date = new DateTime(2013,6,19), Value = 499.12m},new Dolar() { Date = new DateTime(2013,7,19), Value = 499.52m},new Dolar() { Date = new DateTime(2013,8,19), Value = 510.35m},new Dolar() { Date = new DateTime(2013,11,19), Value = 517.33m},new Dolar() { Date = new DateTime(2013,12,19), Value = 528.19m},new Dolar() { Date = new DateTime(2013,2,20), Value = 472.21m},new Dolar() { Date = new DateTime(2013,3,20), Value = 472.34m},new Dolar() { Date = new DateTime(2013,5,20), Value = 480.81m},new Dolar() { Date = new DateTime(2013,6,20), Value = 500.68m},new Dolar() { Date = new DateTime(2013,8,20), Value = 516.83m},new Dolar() { Date = new DateTime(2013,11,20), Value = 519.22m},new Dolar() { Date = new DateTime(2013,12,20), Value = 530.02m},new Dolar() { Date = new DateTime(2013,1,21), Value = 471.63m},new Dolar() { Date = new DateTime(2013,2,21), Value = 472.83m},new Dolar() { Date = new DateTime(2013,3,21), Value = 472.79m},new Dolar() { Date = new DateTime(2013,6,21), Value = 512.60m},new Dolar() { Date = new DateTime(2013,8,21), Value = 516.38m},new Dolar() { Date = new DateTime(2013,10,21), Value = 495.99m},new Dolar() { Date = new DateTime(2013,11,21), Value = 522.67m},new Dolar() { Date = new DateTime(2013,1,22), Value = 472.02m},new Dolar() { Date = new DateTime(2013,2,22), Value = 473.60m},new Dolar() { Date = new DateTime(2013,3,22), Value = 473.03m},new Dolar() { Date = new DateTime(2013,4,22), Value = 476.80m},new Dolar() { Date = new DateTime(2013,5,22), Value = 483.39m},new Dolar() { Date = new DateTime(2013,7,22), Value = 502.37m},new Dolar() { Date = new DateTime(2013,8,22), Value = 515.87m},new Dolar() { Date = new DateTime(2013,10,22), Value = 500.49m},new Dolar() { Date = new DateTime(2013,11,22), Value = 522.73m},new Dolar() { Date = new DateTime(2013,1,23), Value = 471.45m},new Dolar() { Date = new DateTime(2013,4,23), Value = 477.74m},new Dolar() { Date = new DateTime(2013,5,23), Value = 484.51m},new Dolar() { Date = new DateTime(2013,7,23), Value = 503.05m},new Dolar() { Date = new DateTime(2013,8,23), Value = 513.65m},new Dolar() { Date = new DateTime(2013,9,23), Value = 503.23m},new Dolar() { Date = new DateTime(2013,10,23), Value = 500.01m},new Dolar() { Date = new DateTime(2013,12,23), Value = 530.88m},new Dolar() { Date = new DateTime(2013,1,24), Value = 470.98m},new Dolar() { Date = new DateTime(2013,4,24), Value = 477.42m},new Dolar() { Date = new DateTime(2013,5,24), Value = 488.85m},new Dolar() { Date = new DateTime(2013,6,24), Value = 514.38m},new Dolar() { Date = new DateTime(2013,7,24), Value = 504.35m},new Dolar() { Date = new DateTime(2013,9,24), Value = 496.49m},new Dolar() { Date = new DateTime(2013,10,24), Value = 503.08m},new Dolar() { Date = new DateTime(2013,12,24), Value = 527.65m},new Dolar() { Date = new DateTime(2013,1,25), Value = 470.68m},new Dolar() { Date = new DateTime(2013,2,25), Value = 473.18m},new Dolar() { Date = new DateTime(2013,3,25), Value = 472.77m},new Dolar() { Date = new DateTime(2013,4,25), Value = 474.84m},new Dolar() { Date = new DateTime(2013,6,25), Value = 513.40m},new Dolar() { Date = new DateTime(2013,7,25), Value = 504.34m},new Dolar() { Date = new DateTime(2013,9,25), Value = 497.19m},new Dolar() { Date = new DateTime(2013,10,25), Value = 504.61m},new Dolar() { Date = new DateTime(2013,11,25), Value = 520.37m},new Dolar() { Date = new DateTime(2013,2,26), Value = 473.02m},new Dolar() { Date = new DateTime(2013,3,26), Value = 472.60m},new Dolar() { Date = new DateTime(2013,4,26), Value = 472.73m},new Dolar() { Date = new DateTime(2013,6,26), Value = 508.56m},new Dolar() { Date = new DateTime(2013,7,26), Value = 505.43m},new Dolar() { Date = new DateTime(2013,8,26), Value = 509.75m},new Dolar() { Date = new DateTime(2013,9,26), Value = 500.28m},new Dolar() { Date = new DateTime(2013,11,26), Value = 520.54m},new Dolar() { Date = new DateTime(2013,12,26), Value = 528.03m},new Dolar() { Date = new DateTime(2013,2,27), Value = 473.44m},new Dolar() { Date = new DateTime(2013,3,27), Value = 472.61m},new Dolar() { Date = new DateTime(2013,5,27), Value = 488.86m},new Dolar() { Date = new DateTime(2013,6,27), Value = 505.02m},new Dolar() { Date = new DateTime(2013,8,27), Value = 511.28m},new Dolar() { Date = new DateTime(2013,9,27), Value = 500.22m},new Dolar() { Date = new DateTime(2013,11,27), Value = 522.23m},new Dolar() { Date = new DateTime(2013,12,27), Value = 525.24m},new Dolar() { Date = new DateTime(2013,1,28), Value = 470.99m},new Dolar() { Date = new DateTime(2013,2,28), Value = 473.30m},new Dolar() { Date = new DateTime(2013,3,28), Value = 472.54m},new Dolar() { Date = new DateTime(2013,5,28), Value = 489.99m},new Dolar() { Date = new DateTime(2013,6,28), Value = 503.86m},new Dolar() { Date = new DateTime(2013,8,28), Value = 515.16m},new Dolar() { Date = new DateTime(2013,10,28), Value = 505.32m},new Dolar() { Date = new DateTime(2013,11,28), Value = 524.10m},new Dolar() { Date = new DateTime(2013,1,29), Value = 472.56m},new Dolar() { Date = new DateTime(2013,4,29), Value = 472.05m},new Dolar() { Date = new DateTime(2013,5,29), Value = 490.31m},new Dolar() { Date = new DateTime(2013,7,29), Value = 506.50m},new Dolar() { Date = new DateTime(2013,8,29), Value = 513.63m},new Dolar() { Date = new DateTime(2013,10,29), Value = 506.97m},new Dolar() { Date = new DateTime(2013,11,29), Value = 528.19m},new Dolar() { Date = new DateTime(2013,1,30), Value = 472.73m},new Dolar() { Date = new DateTime(2013,4,30), Value = 471.54m},new Dolar() { Date = new DateTime(2013,5,30), Value = 490.65m},new Dolar() { Date = new DateTime(2013,7,30), Value = 509.89m},new Dolar() { Date = new DateTime(2013,8,30), Value = 511.65m},new Dolar() { Date = new DateTime(2013,9,30), Value = 502.97m},new Dolar() { Date = new DateTime(2013,10,30), Value = 508.58m},new Dolar() { Date = new DateTime(2013,12,30), Value = 523.76m},new Dolar() { Date = new DateTime(2013,1,31), Value = 471.40m},new Dolar() { Date = new DateTime(2013,5,31), Value = 492.80m},new Dolar() { Date = new DateTime(2013,7,31), Value = 514.34m},
   
                };

                #endregion
            List<Dolar> dolars = new List<Dolar>(366);
            dolars.AddRange(expectedDollars);
            scraper.Extract();
            Assert.That(scraper.Dolars, Is.EquivalentTo(dolars));
        }
    }
}
